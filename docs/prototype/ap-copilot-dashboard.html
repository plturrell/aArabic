<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AP Automation Co-Pilot | Invoice Validation</title>
    <!-- SAP 72 Font -->
    <link href="https://fonts.googleapis.com/css2?family=72:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* SAP Quartz Light Theme Variables */
        :root {
            /* Shell & Background */
            --sapShellColor: #354A5F;
            --sapBackgroundColor: #F7F7F7;
            --sapBaseColor: #FFFFFF;
            --sapGroupContentBackground: #FFFFFF;

            /* Brand Colors */
            --sapBrandColor: #0A6ED1;
            --sapHighlightColor: #0A6ED1;
            --sapActiveColor: #0854A0;

            /* Text Colors */
            --sapTextColor: #32363A;
            --sapTitleColor: #32363A;
            --sapContent_LabelColor: #6A6D70;
            --sapLink_Color: #0A6ED1;

            /* Semantic Colors */
            --sapPositiveColor: #107E3E;
            --sapPositiveBackground: #F1FDF6;
            --sapCriticalColor: #E9730C;
            --sapCriticalBackground: #FEF7F1;
            --sapNegativeColor: #BB0000;
            --sapNegativeBackground: #FFEBEB;
            --sapNeutralColor: #6A6D70;
            --sapInformativeColor: #0A6ED1;
            --sapInformativeBackground: #F5FAFF;

            /* Border & Shadow */
            --sapContent_BorderColor: #89919A;
            --sapField_BorderColor: #89919A;
            --sapGroup_BorderColor: #D9D9D9;
            --sapShadow: 0 0 0 1px rgba(0,0,0,0.05), 0 0.125rem 0.5rem rgba(0,0,0,0.1);

            /* Sizing */
            --sapElement_Height: 2.25rem;
            --sapElement_Compact_Height: 1.625rem;
            --sapFontSize: 0.875rem;
            --sapFontHeaderSize: 1rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: '72', 'SAP 72', Arial, Helvetica, sans-serif;
            font-size: var(--sapFontSize);
            color: var(--sapTextColor);
            background-color: var(--sapBackgroundColor);
            line-height: 1.4;
        }

        /* SAP Shell Header */
        .sap-shell-header {
            background-color: var(--sapShellColor);
            height: 2.75rem;
            display: flex;
            align-items: center;
            padding: 0 1rem;
            color: #FFFFFF;
        }

        .shell-logo {
            font-weight: 700;
            font-size: 1rem;
            margin-right: 1.5rem;
        }

        .shell-title {
            font-weight: 400;
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .shell-spacer {
            flex: 1;
        }

        .shell-user {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .shell-avatar {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            background: #D1E8FF;
            color: var(--sapShellColor);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            font-size: 0.75rem;
        }

        /* Page Header */
        .page-header {
            background: var(--sapBaseColor);
            border-bottom: 1px solid var(--sapGroup_BorderColor);
            padding: 1rem 2rem;
        }

        .page-header h1 {
            font-size: 1.5rem;
            font-weight: 400;
            color: var(--sapTitleColor);
            margin-bottom: 0.25rem;
        }

        .page-header-subtitle {
            color: var(--sapContent_LabelColor);
            font-size: 0.875rem;
        }

        .page-header-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* SAP Buttons */
        .sap-button {
            height: var(--sapElement_Height);
            padding: 0 0.75rem;
            border-radius: 0.25rem;
            font-family: inherit;
            font-size: var(--sapFontSize);
            font-weight: 400;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            border: 1px solid transparent;
            transition: all 0.1s;
        }

        .sap-button-emphasized {
            background: var(--sapBrandColor);
            color: #FFFFFF;
            border-color: var(--sapBrandColor);
        }

        .sap-button-emphasized:hover {
            background: var(--sapActiveColor);
            border-color: var(--sapActiveColor);
        }

        .sap-button-default {
            background: var(--sapBaseColor);
            color: var(--sapBrandColor);
            border-color: var(--sapBrandColor);
        }

        .sap-button-default:hover {
            background: #F7F7F7;
        }

        .sap-button-ghost {
            background: transparent;
            color: var(--sapBrandColor);
            border-color: transparent;
        }

        .sap-button-ghost:hover {
            background: rgba(10, 110, 209, 0.08);
        }

        .sap-button-positive {
            background: var(--sapPositiveColor);
            color: #FFFFFF;
            border-color: var(--sapPositiveColor);
        }

        /* Main Content */
        .main-content {
            padding: 1rem 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            height: calc(100vh - 2.75rem - 7rem - 3.5rem);
        }

        /* SAP Panel/Card */
        .sap-panel {
            background: var(--sapGroupContentBackground);
            border-radius: 0.5rem;
            box-shadow: var(--sapShadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .sap-panel-header {
            padding: 1rem;
            border-bottom: 1px solid var(--sapGroup_BorderColor);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #FAFAFA;
        }

        .sap-panel-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--sapTitleColor);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sap-panel-content {
            padding: 1rem;
            flex: 1;
            overflow-y: auto;
        }

        /* Invoice Preview (Left Panel) */
        .invoice-preview {
            background: #FAFAFA;
            border: 1px solid var(--sapGroup_BorderColor);
            border-radius: 0.25rem;
            padding: 1.5rem;
            direction: rtl;
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            height: 100%;
            overflow-y: auto;
        }

        .invoice-header-ar {
            text-align: center;
            border-bottom: 2px solid var(--sapTitleColor);
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }

        .invoice-header-ar h2 {
            font-size: 1.5rem;
            color: var(--sapTitleColor);
            margin-bottom: 0.5rem;
        }

        .invoice-header-ar p {
            color: var(--sapContent_LabelColor);
            font-size: 0.875rem;
        }

        .invoice-details-ar {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .invoice-field-ar {
            padding: 0.5rem;
            background: #FFFFFF;
            border-radius: 0.25rem;
        }

        .invoice-field-ar label {
            font-size: 0.75rem;
            color: var(--sapContent_LabelColor);
            display: block;
            margin-bottom: 0.25rem;
        }

        .invoice-field-ar span {
            font-size: 0.9375rem;
            color: var(--sapTitleColor);
            font-weight: 500;
        }

        .invoice-table-ar {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            font-size: 0.8125rem;
        }

        .invoice-table-ar th {
            background: var(--sapShellColor);
            color: #FFFFFF;
            padding: 0.625rem;
            text-align: right;
            font-weight: 500;
        }

        .invoice-table-ar td {
            padding: 0.625rem;
            border-bottom: 1px solid var(--sapGroup_BorderColor);
            text-align: right;
        }

        .invoice-table-ar tfoot td {
            font-weight: 700;
            background: #F5F5F5;
        }

        /* Form Fields (Right Panel) */
        .sap-form-group {
            margin-bottom: 1rem;
        }

        .sap-form-label {
            display: block;
            font-size: 0.875rem;
            color: var(--sapContent_LabelColor);
            margin-bottom: 0.25rem;
        }

        .sap-form-label.required::after {
            content: ' *';
            color: var(--sapNegativeColor);
        }

        .sap-input-wrapper {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sap-input {
            flex: 1;
            height: var(--sapElement_Height);
            padding: 0 0.75rem;
            border: 1px solid var(--sapField_BorderColor);
            border-radius: 0.25rem;
            font-family: inherit;
            font-size: var(--sapFontSize);
            color: var(--sapTextColor);
            background: var(--sapBaseColor);
        }

        .sap-input:focus {
            outline: none;
            border-color: var(--sapBrandColor);
            box-shadow: 0 0 0 2px rgba(10, 110, 209, 0.16);
        }

        .sap-input:read-only {
            background: #F7F7F7;
        }

        /* Confidence Badges */
        .confidence-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .confidence-high {
            background: var(--sapPositiveBackground);
            color: var(--sapPositiveColor);
            border: 1px solid var(--sapPositiveColor);
        }

        .confidence-medium {
            background: var(--sapCriticalBackground);
            color: var(--sapCriticalColor);
            border: 1px solid var(--sapCriticalColor);
        }

        .confidence-low {
            background: var(--sapNegativeBackground);
            color: var(--sapNegativeColor);
            border: 1px solid var(--sapNegativeColor);
        }

        .confidence-icon {
            width: 0.875rem;
            height: 0.875rem;
        }

        /* Ariba Match Section */
        .ariba-match-section {
            background: var(--sapInformativeBackground);
            border: 1px solid var(--sapBrandColor);
            border-radius: 0.25rem;
            padding: 1rem;
            margin-top: 1rem;
        }

        .ariba-match-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            font-weight: 500;
            color: var(--sapBrandColor);
        }

        .ariba-match-result {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            background: var(--sapBaseColor);
            border-radius: 0.25rem;
            margin-bottom: 0.5rem;
        }

        .ariba-match-result.match-exact {
            border-left: 4px solid var(--sapPositiveColor);
        }

        .ariba-match-result.match-partial {
            border-left: 4px solid var(--sapCriticalColor);
        }

        .ariba-match-result.match-none {
            border-left: 4px solid var(--sapNegativeColor);
        }

        .match-score {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .match-score.high { color: var(--sapPositiveColor); }
        .match-score.medium { color: var(--sapCriticalColor); }
        .match-score.low { color: var(--sapNegativeColor); }

        .match-details {
            flex: 1;
        }

        .match-supplier-name {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .match-supplier-id {
            font-size: 0.75rem;
            color: var(--sapContent_LabelColor);
        }

        /* Footer Section */
        .page-footer {
            background: var(--sapBaseColor);
            border-top: 1px solid var(--sapGroup_BorderColor);
            padding: 0.75rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .footer-info {
            display: flex;
            align-items: center;
            gap: 2rem;
            font-size: 0.8125rem;
            color: var(--sapContent_LabelColor);
        }

        .footer-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Audit Trail Panel */
        .audit-trail-toggle {
            position: fixed;
            bottom: 5rem;
            right: 2rem;
            z-index: 100;
        }

        .audit-trail-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--sapBaseColor);
            border-top: 1px solid var(--sapGroup_BorderColor);
            box-shadow: 0 -4px 16px rgba(0, 0, 0, 0.1);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            z-index: 99;
        }

        .audit-trail-panel.expanded {
            max-height: 300px;
        }

        .audit-trail-header {
            padding: 0.75rem 2rem;
            background: #FAFAFA;
            border-bottom: 1px solid var(--sapGroup_BorderColor);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .audit-trail-title {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .audit-trail-content {
            padding: 1rem 2rem;
            max-height: 220px;
            overflow-y: auto;
        }

        .audit-entry {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--sapGroup_BorderColor);
        }

        .audit-entry:last-child {
            border-bottom: none;
        }

        .audit-timestamp {
            font-size: 0.75rem;
            color: var(--sapContent_LabelColor);
            min-width: 140px;
        }

        .audit-icon {
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
        }

        .audit-icon.extraction { background: var(--sapInformativeBackground); color: var(--sapInformativeColor); }
        .audit-icon.translation { background: #F3E8FF; color: #7C3AED; }
        .audit-icon.validation { background: var(--sapPositiveBackground); color: var(--sapPositiveColor); }
        .audit-icon.override { background: var(--sapCriticalBackground); color: var(--sapCriticalColor); }

        .audit-message {
            flex: 1;
            font-size: 0.8125rem;
        }

        .audit-field {
            font-weight: 500;
        }

        /* Status Bar */
        .status-bar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--sapPositiveBackground);
            border: 1px solid var(--sapPositiveColor);
            border-radius: 0.25rem;
            margin-bottom: 1rem;
        }

        .status-bar.warning {
            background: var(--sapCriticalBackground);
            border-color: var(--sapCriticalColor);
        }

        .status-bar-icon {
            color: var(--sapPositiveColor);
        }

        .status-bar.warning .status-bar-icon {
            color: var(--sapCriticalColor);
        }

        /* Object Status */
        .object-status {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            font-size: 0.8125rem;
        }

        .object-status-dot {
            width: 0.5rem;
            height: 0.5rem;
            border-radius: 50%;
        }

        .object-status.positive .object-status-dot { background: var(--sapPositiveColor); }
        .object-status.critical .object-status-dot { background: var(--sapCriticalColor); }
        .object-status.negative .object-status-dot { background: var(--sapNegativeColor); }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
                height: auto;
            }

            .sap-panel {
                min-height: 400px;
            }
        }

        /* Icon styles */
        .icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        /* AI Copilot Styles */
        .copilot-fab {
            position: fixed;
            bottom: 5rem;
            right: 2rem;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            background: linear-gradient(135deg, #0A6ED1 0%, #0854A0 100%);
            border: none;
            color: #FFFFFF;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(10, 110, 209, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            z-index: 1000;
        }

        .copilot-fab:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(10, 110, 209, 0.5);
        }

        .copilot-fab.active {
            background: var(--sapNegativeColor);
        }

        .copilot-fab svg {
            width: 1.5rem;
            height: 1.5rem;
        }

        .copilot-panel {
            position: fixed;
            top: 2.75rem;
            right: -400px;
            width: 400px;
            height: calc(100vh - 2.75rem);
            background: var(--sapBaseColor);
            border-left: 1px solid var(--sapGroup_BorderColor);
            box-shadow: -4px 0 16px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            transition: right 0.3s ease;
            z-index: 999;
        }

        .copilot-panel.open {
            right: 0;
        }

        .copilot-header {
            padding: 1rem;
            background: linear-gradient(135deg, #0A6ED1 0%, #0854A0 100%);
            color: #FFFFFF;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .copilot-header-icon {
            width: 2.5rem;
            height: 2.5rem;
            background: rgba(255,255,255,0.2);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .copilot-header-text h3 {
            font-size: 1rem;
            font-weight: 500;
            margin-bottom: 0.125rem;
        }

        .copilot-header-text p {
            font-size: 0.6875rem;
            opacity: 0.85;
        }

        .copilot-status {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 0.375rem;
            font-size: 0.6875rem;
            background: rgba(255,255,255,0.15);
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
        }

        .copilot-status-dot {
            width: 0.5rem;
            height: 0.5rem;
            background: #4ADE80;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .copilot-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .copilot-message {
            display: flex;
            gap: 0.75rem;
            max-width: 95%;
        }

        .copilot-message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .copilot-message-avatar {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            flex-shrink: 0;
        }

        .copilot-message.assistant .copilot-message-avatar {
            background: linear-gradient(135deg, #0A6ED1 0%, #0854A0 100%);
            color: #FFFFFF;
        }

        .copilot-message.user .copilot-message-avatar {
            background: #E5E5E5;
            color: var(--sapTextColor);
        }

        .copilot-message-content {
            background: #F5F5F5;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            font-size: 0.8125rem;
            line-height: 1.5;
        }

        .copilot-message.user .copilot-message-content {
            background: var(--sapBrandColor);
            color: #FFFFFF;
            border-bottom-right-radius: 0.25rem;
        }

        .copilot-message.assistant .copilot-message-content {
            border-bottom-left-radius: 0.25rem;
        }

        .copilot-message-content code {
            background: rgba(0,0,0,0.08);
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
        }

        .copilot-message.user .copilot-message-content code {
            background: rgba(255,255,255,0.2);
        }

        .copilot-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .copilot-suggestion {
            background: var(--sapBaseColor);
            border: 1px solid var(--sapBrandColor);
            color: var(--sapBrandColor);
            padding: 0.375rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.15s;
        }

        .copilot-suggestion:hover {
            background: var(--sapBrandColor);
            color: #FFFFFF;
        }

        .copilot-input-area {
            padding: 1rem;
            border-top: 1px solid var(--sapGroup_BorderColor);
            background: #FAFAFA;
        }

        .copilot-input-wrapper {
            display: flex;
            gap: 0.5rem;
            align-items: flex-end;
        }

        .copilot-input {
            flex: 1;
            min-height: 2.5rem;
            max-height: 6rem;
            padding: 0.625rem 1rem;
            border: 1px solid var(--sapField_BorderColor);
            border-radius: 1.25rem;
            font-family: inherit;
            font-size: 0.875rem;
            resize: none;
            outline: none;
        }

        .copilot-input:focus {
            border-color: var(--sapBrandColor);
        }

        .copilot-send {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background: var(--sapBrandColor);
            border: none;
            color: #FFFFFF;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.15s;
        }

        .copilot-send:hover {
            background: var(--sapActiveColor);
        }

        .copilot-send:disabled {
            background: #CCC;
            cursor: not-allowed;
        }

        .copilot-backend-info {
            padding: 0.5rem 1rem;
            background: #F0F4F8;
            border-top: 1px solid var(--sapGroup_BorderColor);
            font-size: 0.6875rem;
            color: var(--sapContent_LabelColor);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .backend-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.125rem 0.375rem;
            background: #E0E7FF;
            color: #3730A3;
            border-radius: 0.25rem;
            font-weight: 500;
        }

        .copilot-typing {
            display: flex;
            gap: 0.25rem;
            padding: 0.5rem;
        }

        .copilot-typing span {
            width: 0.5rem;
            height: 0.5rem;
            background: var(--sapContent_LabelColor);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .copilot-typing span:nth-child(2) { animation-delay: 0.2s; }
        .copilot-typing span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-0.375rem); opacity: 1; }
        }

        /* Adjust main content when copilot is open */
        body.copilot-open .main-content {
            margin-right: 400px;
        }

        body.copilot-open .page-footer {
            margin-right: 400px;
        }

        body.copilot-open .audit-trail-panel {
            right: 400px;
        }
    </style>
</head>
<body>
    <!-- SAP Shell Header -->
    <header class="sap-shell-header">
        <div class="shell-logo">SAP</div>
        <div class="shell-title">AP Automation Co-Pilot</div>
        <div class="shell-spacer"></div>
        <div class="shell-user">
            <span>Craig Turrell</span>
            <div class="shell-avatar">CT</div>
        </div>
    </header>

    <!-- Page Header -->
    <div class="page-header">
        <h1>Invoice Validation</h1>
        <p class="page-header-subtitle">Invoice #INV-2025-04721 | ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿÆŸÑŸäÿ¨ ŸÑŸÑÿ™ÿ¨ÿßÿ±ÿ© ÿßŸÑÿπÿßŸÖÿ©</p>
        <div class="page-header-actions">
            <button class="sap-button sap-button-ghost">
                <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 12.5a5.5 5.5 0 110-11 5.5 5.5 0 010 11zM7.25 4v4.5l3.5 2-.75 1.25-4.25-2.5V4h1.5z"/>
                </svg>
                History
            </button>
            <button class="sap-button sap-button-ghost">
                <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M13.5 2h-11A1.5 1.5 0 001 3.5v9A1.5 1.5 0 002.5 14h11a1.5 1.5 0 001.5-1.5v-9A1.5 1.5 0 0013.5 2zm-11 1h11a.5.5 0 01.5.5v1.5H2V3.5a.5.5 0 01.5-.5zm11 10h-11a.5.5 0 01-.5-.5V6h12v6.5a.5.5 0 01-.5.5z"/>
                </svg>
                Attachments (3)
            </button>
            <button class="sap-button sap-button-default">
                <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 1C4.134 1 1 4.134 1 8s3.134 7 7 7 7-3.134 7-7-3.134-7-7-7zm0 12.5A5.506 5.506 0 012.5 8c0-3.033 2.467-5.5 5.5-5.5s5.5 2.467 5.5 5.5-2.467 5.5-5.5 5.5zm.5-9h-1v4.793l3.146 3.147.708-.708L8.5 8.378V4.5z"/>
                </svg>
                Re-extract
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Left Panel: Original Arabic Invoice -->
        <div class="sap-panel">
            <div class="sap-panel-header">
                <span class="sap-panel-title">
                    <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M14 1H2a1 1 0 00-1 1v12a1 1 0 001 1h12a1 1 0 001-1V2a1 1 0 00-1-1zM2 14V2h12v12H2z"/>
                        <path d="M4 4h8v1H4zM4 7h8v1H4zM4 10h5v1H4z"/>
                    </svg>
                    Original Invoice (Arabic)
                </span>
                <span class="object-status positive">
                    <span class="object-status-dot"></span>
                    PDF Extracted
                </span>
            </div>
            <div class="sap-panel-content">
                <div class="invoice-preview">
                    <div class="invoice-header-ar">
                        <h2>ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿÆŸÑŸäÿ¨ ŸÑŸÑÿ™ÿ¨ÿßÿ±ÿ© ÿßŸÑÿπÿßŸÖÿ©</h2>
                        <p>Gulf General Trading Company LLC</p>
                        <p style="margin-top: 0.5rem; font-size: 0.75rem;">
                            ÿµ.ÿ®. Ÿ°Ÿ¢Ÿ£Ÿ§Ÿ•ÿå ÿßŸÑÿ±Ÿäÿßÿ∂ÿå ÿßŸÑŸÖŸÖŸÑŸÉÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©<br>
                            ÿßŸÑÿ±ŸÇŸÖ ÿßŸÑÿ∂ÿ±Ÿäÿ®Ÿä: 300123456789003
                        </p>
                    </div>

                    <div style="text-align: center; margin: 1rem 0; font-size: 1.25rem; font-weight: bold; color: var(--sapBrandColor);">
                        ŸÅÿßÿ™Ÿàÿ±ÿ© ÿ∂ÿ±Ÿäÿ®Ÿäÿ©
                    </div>

                    <div class="invoice-details-ar">
                        <div class="invoice-field-ar">
                            <label>ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</label>
                            <span>INV-2025-04721</span>
                        </div>
                        <div class="invoice-field-ar">
                            <label>ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</label>
                            <span>Ÿ¢Ÿ†Ÿ¢Ÿ•/Ÿ†Ÿ°/Ÿ†Ÿ•</span>
                        </div>
                        <div class="invoice-field-ar">
                            <label>ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ</label>
                            <span>ÿ≥ÿ™ÿßŸÜÿØÿ±ÿØ ÿ™ÿ¥ÿßÿ±ÿ™ÿ±ÿØ</span>
                        </div>
                        <div class="invoice-field-ar">
                            <label>ÿ¥ÿ±Ÿàÿ∑ ÿßŸÑÿØŸÅÿπ</label>
                            <span>ÿµÿßŸÅŸä Ÿ£Ÿ† ŸäŸàŸÖ</span>
                        </div>
                    </div>

                    <table class="invoice-table-ar">
                        <thead>
                            <tr>
                                <th>ÿßŸÑŸàÿµŸÅ</th>
                                <th>ÿßŸÑŸÉŸÖŸäÿ©</th>
                                <th>ÿ≥ÿπÿ± ÿßŸÑŸàÿ≠ÿØÿ©</th>
                                <th>ÿßŸÑŸÖÿ¨ŸÖŸàÿπ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ÿÆÿØŸÖÿßÿ™ ÿßÿ≥ÿ™ÿ¥ÿßÿ±Ÿäÿ© - ÿßŸÑÿ±ÿ®ÿπ ÿßŸÑÿ±ÿßÿ®ÿπ Ÿ¢Ÿ†Ÿ¢Ÿ§</td>
                                <td>Ÿ°</td>
                                <td>Ÿ§Ÿ•,Ÿ†Ÿ†Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                                <td>Ÿ§Ÿ•,Ÿ†Ÿ†Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                            </tr>
                            <tr>
                                <td>ÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© ŸàÿßŸÑÿ™Ÿàÿ´ŸäŸÇ</td>
                                <td>Ÿ°</td>
                                <td>Ÿ¢,Ÿ•Ÿ†Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                                <td>Ÿ¢,Ÿ•Ÿ†Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                            </tr>
                            <tr>
                                <td>ŸÖÿµÿßÿ±ŸäŸÅ ÿßŸÑÿ≥ŸÅÿ± ŸàÿßŸÑÿ•ŸÇÿßŸÖÿ©</td>
                                <td>Ÿ°</td>
                                <td>Ÿß,Ÿ•Ÿ†Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                                <td>Ÿß,Ÿ•Ÿ†Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3">ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÅÿ±ÿπŸä</td>
                                <td>Ÿ•Ÿ•,Ÿ†Ÿ†Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                            </tr>
                            <tr>
                                <td colspan="3">ÿ∂ÿ±Ÿäÿ®ÿ© ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑŸÖÿ∂ÿßŸÅÿ© (Ÿ°Ÿ•Ÿ™)</td>
                                <td>Ÿ®,Ÿ¢Ÿ•Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                            </tr>
                            <tr style="font-size: 1.1rem;">
                                <td colspan="3">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä</td>
                                <td>Ÿ¶Ÿ£,Ÿ¢Ÿ•Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>

        <!-- Right Panel: Ariba Submission Form -->
        <div class="sap-panel">
            <div class="sap-panel-header">
                <span class="sap-panel-title">
                    <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M13 1H3a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V3a2 2 0 00-2-2zm0 12H3V3h10v10z"/>
                        <path d="M5 6h6v1H5zM5 8h6v1H5zM5 10h4v1H5z"/>
                    </svg>
                    Ariba Submission Form
                </span>
                <span class="object-status critical">
                    <span class="object-status-dot"></span>
                    2 Fields Need Review
                </span>
            </div>
            <div class="sap-panel-content">
                <div class="status-bar warning">
                    <svg class="status-bar-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 12.5a5.5 5.5 0 110-11 5.5 5.5 0 010 11z"/>
                        <path d="M7.25 4.5h1.5v4h-1.5zM7.25 10h1.5v1.5h-1.5z"/>
                    </svg>
                    <span>2 fields require manual review before submission</span>
                </div>

                <!-- Form Fields -->
                <div class="sap-form-group">
                    <label class="sap-form-label required">Supplier Name</label>
                    <div class="sap-input-wrapper">
                        <input type="text" class="sap-input" value="Gulf General Trading Company LLC" readonly>
                        <span class="confidence-badge confidence-high">
                            <svg class="confidence-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.854 5.146l-4.5 4.5a.5.5 0 01-.708 0l-2-2a.5.5 0 11.708-.708L7 9.586l4.146-4.147a.5.5 0 01.708.708z"/>
                            </svg>
                            98% High
                        </span>
                    </div>
                </div>

                <div class="sap-form-group">
                    <label class="sap-form-label required">Invoice Number</label>
                    <div class="sap-input-wrapper">
                        <input type="text" class="sap-input" value="INV-2025-04721" readonly>
                        <span class="confidence-badge confidence-high">
                            <svg class="confidence-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.854 5.146l-4.5 4.5a.5.5 0 01-.708 0l-2-2a.5.5 0 11.708-.708L7 9.586l4.146-4.147a.5.5 0 01.708.708z"/>
                            </svg>
                            99% High
                        </span>
                    </div>
                </div>

                <div class="sap-form-group">
                    <label class="sap-form-label required">Invoice Date</label>
                    <div class="sap-input-wrapper">
                        <input type="text" class="sap-input" value="2025-01-05" readonly>
                        <span class="confidence-badge confidence-high">
                            <svg class="confidence-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.854 5.146l-4.5 4.5a.5.5 0 01-.708 0l-2-2a.5.5 0 11.708-.708L7 9.586l4.146-4.147a.5.5 0 01.708.708z"/>
                            </svg>
                            97% High
                        </span>
                    </div>
                </div>

                <div class="sap-form-group">
                    <label class="sap-form-label required">Tax ID / VAT Number</label>
                    <div class="sap-input-wrapper">
                        <input type="text" class="sap-input" value="300123456789003" style="border-color: var(--sapCriticalColor);">
                        <span class="confidence-badge confidence-medium">
                            <svg class="confidence-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 12.5a5.5 5.5 0 110-11 5.5 5.5 0 010 11z"/>
                                <path d="M7.25 4.5h1.5v4h-1.5zM7.25 10h1.5v1.5h-1.5z"/>
                            </svg>
                            78% Check
                        </span>
                    </div>
                </div>

                <div class="sap-form-group">
                    <label class="sap-form-label required">Total Amount (SAR)</label>
                    <div class="sap-input-wrapper">
                        <input type="text" class="sap-input" value="63,250.00" readonly>
                        <span class="confidence-badge confidence-high">
                            <svg class="confidence-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.854 5.146l-4.5 4.5a.5.5 0 01-.708 0l-2-2a.5.5 0 11.708-.708L7 9.586l4.146-4.147a.5.5 0 01.708.708z"/>
                            </svg>
                            99% High
                        </span>
                    </div>
                </div>

                <div class="sap-form-group">
                    <label class="sap-form-label">VAT Amount (15%)</label>
                    <div class="sap-input-wrapper">
                        <input type="text" class="sap-input" value="8,250.00" readonly>
                        <span class="confidence-badge confidence-high">
                            <svg class="confidence-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.854 5.146l-4.5 4.5a.5.5 0 01-.708 0l-2-2a.5.5 0 11.708-.708L7 9.586l4.146-4.147a.5.5 0 01.708.708z"/>
                            </svg>
                            99% High
                        </span>
                    </div>
                </div>

                <div class="sap-form-group">
                    <label class="sap-form-label">Payment Terms</label>
                    <div class="sap-input-wrapper">
                        <input type="text" class="sap-input" value="Net 30" style="border-color: var(--sapNegativeColor);">
                        <span class="confidence-badge confidence-low">
                            <svg class="confidence-icon" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 12.5a5.5 5.5 0 110-11 5.5 5.5 0 010 11z"/>
                                <path d="M5.146 5.146a.5.5 0 01.708 0L8 7.293l2.146-2.147a.5.5 0 01.708.708L8.707 8l2.147 2.146a.5.5 0 01-.708.708L8 8.707l-2.146 2.147a.5.5 0 01-.708-.708L7.293 8 5.146 5.854a.5.5 0 010-.708z"/>
                            </svg>
                            52% Review
                        </span>
                    </div>
                </div>

                <!-- Ariba Match Section -->
                <div class="ariba-match-section">
                    <div class="ariba-match-header">
                        <svg class="icon" width="18" height="18" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.5 7.5h-3v3h-1v-3h-3v-1h3v-3h1v3h3v1z"/>
                        </svg>
                        Ariba Supplier Match
                    </div>

                    <div class="ariba-match-result match-exact">
                        <span class="match-score high">98%</span>
                        <div class="match-details">
                            <div class="match-supplier-name">Gulf General Trading Company LLC</div>
                            <div class="match-supplier-id">Ariba ID: GGTC-SA-001 | Status: Approved</div>
                        </div>
                        <span class="confidence-badge confidence-high">Exact Match</span>
                    </div>

                    <div class="ariba-match-result match-partial">
                        <span class="match-score medium">72%</span>
                        <div class="match-details">
                            <div class="match-supplier-name">Gulf Trading & General Services</div>
                            <div class="match-supplier-id">Ariba ID: GTGS-SA-023 | Status: Approved</div>
                        </div>
                        <span class="confidence-badge confidence-medium">Partial</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Page Footer -->
    <footer class="page-footer">
        <div class="footer-info">
            <span>Last extracted: 07 Jan 2025, 13:45:22</span>
            <span>Processing time: 2.3s</span>
            <span>Confidence score: 89%</span>
        </div>
        <div class="footer-actions">
            <button class="sap-button sap-button-ghost" onclick="toggleAuditTrail()">
                <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M14 1H2a1 1 0 00-1 1v12a1 1 0 001 1h12a1 1 0 001-1V2a1 1 0 00-1-1zm-1 12H3V3h10v10z"/>
                    <path d="M5 5h6v1H5zM5 7h6v1H5zM5 9h6v1H5zM5 11h3v1H5z"/>
                </svg>
                Audit Trail
            </button>
            <button class="sap-button sap-button-default">Save Draft</button>
            <button class="sap-button sap-button-emphasized">
                <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.854 5.146l-4.5 4.5a.5.5 0 01-.708 0l-2-2a.5.5 0 11.708-.708L7 9.586l4.146-4.147a.5.5 0 01.708.708z"/>
                </svg>
                Submit to Ariba
            </button>
        </div>
    </footer>

    <!-- AI Copilot FAB Button -->
    <button class="copilot-fab" id="copilotFab" onclick="toggleCopilot()" title="Open AI Copilot">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 011 1v3a1 1 0 01-1 1h-1v1a2 2 0 01-2 2H5a2 2 0 01-2-2v-1H2a1 1 0 01-1-1v-3a1 1 0 011-1h1a7 7 0 017-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 012-2z"/>
            <circle cx="9" cy="13" r="1.25" fill="currentColor"/>
            <circle cx="15" cy="13" r="1.25" fill="currentColor"/>
            <path d="M9 17h6" stroke-linecap="round"/>
        </svg>
    </button>

    <!-- AI Copilot Panel -->
    <div class="copilot-panel" id="copilotPanel">
        <div class="copilot-header">
            <div class="copilot-header-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 011 1v3a1 1 0 01-1 1h-1v1a2 2 0 01-2 2H5a2 2 0 01-2-2v-1H2a1 1 0 01-1-1v-3a1 1 0 011-1h1a7 7 0 017-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 012-2z"/>
                </svg>
            </div>
            <div class="copilot-header-text">
                <h3>AP Co-Pilot Assistant</h3>
                <p>Powered by U2AI + Rust Shim</p>
            </div>
            <div class="copilot-status">
                <span class="copilot-status-dot"></span>
                Online
            </div>
        </div>

        <div class="copilot-messages" id="copilotMessages">
            <!-- Welcome Message -->
            <div class="copilot-message assistant">
                <div class="copilot-message-avatar">ü§ñ</div>
                <div class="copilot-message-content">
                    <strong>Hello!</strong> I'm your AP Co-Pilot assistant, powered by your <strong>AP DOI</strong> and <strong>Saudi VAT guidelines</strong>.<br><br>
                    I can help you with:<br>
                    ‚Ä¢ Tax invoice compliance (ZATCA checklist)<br>
                    ‚Ä¢ VAT categorization (FI/SI/RC/TCN)<br>
                    ‚Ä¢ PO vs Manual invoice processing<br>
                    ‚Ä¢ GL account mapping<br>
                    ‚Ä¢ Arabic translation & field validation

                    <div class="copilot-suggestions">
                        <button class="copilot-suggestion" onclick="askQuestion('Is this a full tax invoice?')">Check tax type</button>
                        <button class="copilot-suggestion" onclick="askQuestion('Check ZATCA compliance')">ZATCA checklist</button>
                        <button class="copilot-suggestion" onclick="askQuestion('Is a PO required?')">PO required?</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="copilot-backend-info">
            <span>Backend:</span>
            <span class="backend-badge">
                <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                </svg>
                Rust Shim
            </span>
            <span class="backend-badge">
                <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor">
                    <circle cx="12" cy="12" r="10"/>
                </svg>
                U2AI Model
            </span>
            <span style="margin-left: auto;">Latency: 45ms</span>
        </div>

        <div class="copilot-input-area">
            <div class="copilot-input-wrapper">
                <textarea class="copilot-input" id="copilotInput" placeholder="Ask about this invoice..." rows="1" onkeydown="handleInputKeydown(event)"></textarea>
                <button class="copilot-send" onclick="sendMessage()" id="copilotSend">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Audit Trail Panel -->
    <div class="audit-trail-panel" id="auditTrailPanel">
        <div class="audit-trail-header">
            <span class="audit-trail-title">
                <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M14 1H2a1 1 0 00-1 1v12a1 1 0 001 1h12a1 1 0 001-1V2a1 1 0 00-1-1zm-1 12H3V3h10v10z"/>
                    <path d="M5 5h6v1H5zM5 7h6v1H5zM5 9h6v1H5zM5 11h3v1H5z"/>
                </svg>
                Audit Trail - Invoice #INV-2025-04721
            </span>
            <button class="sap-button sap-button-ghost" onclick="toggleAuditTrail()">
                <svg class="icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M4.646 4.646a.5.5 0 01.708 0L8 7.293l2.646-2.647a.5.5 0 01.708.708L8.707 8l2.647 2.646a.5.5 0 01-.708.708L8 8.707l-2.646 2.647a.5.5 0 01-.708-.708L7.293 8 4.646 5.354a.5.5 0 010-.708z"/>
                </svg>
            </button>
        </div>
        <div class="audit-trail-content">
            <div class="audit-entry">
                <span class="audit-timestamp">07 Jan 2025, 13:45:22</span>
                <span class="audit-icon extraction">üìÑ</span>
                <div class="audit-message">
                    <strong>PDF Extraction Started</strong> - Document uploaded and OCR processing initiated
                </div>
            </div>
            <div class="audit-entry">
                <span class="audit-timestamp">07 Jan 2025, 13:45:24</span>
                <span class="audit-icon translation">üåê</span>
                <div class="audit-message">
                    <strong>Arabic ‚Üí English Translation</strong> - <span class="audit-field">Supplier Name</span>: "ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿÆŸÑŸäÿ¨ ŸÑŸÑÿ™ÿ¨ÿßÿ±ÿ© ÿßŸÑÿπÿßŸÖÿ©" ‚Üí "Gulf General Trading Company LLC" (Confidence: 98%)
                </div>
            </div>
            <div class="audit-entry">
                <span class="audit-timestamp">07 Jan 2025, 13:45:24</span>
                <span class="audit-icon extraction">üìÑ</span>
                <div class="audit-message">
                    <strong>Field Extracted</strong> - <span class="audit-field">Invoice Number</span>: "INV-2025-04721" (Confidence: 99%)
                </div>
            </div>
            <div class="audit-entry">
                <span class="audit-timestamp">07 Jan 2025, 13:45:24</span>
                <span class="audit-icon extraction">üìÑ</span>
                <div class="audit-message">
                    <strong>Field Extracted</strong> - <span class="audit-field">Total Amount</span>: "Ÿ¶Ÿ£,Ÿ¢Ÿ•Ÿ†.Ÿ†Ÿ† ÿ±.ÿ≥" ‚Üí "63,250.00 SAR" (Confidence: 99%)
                </div>
            </div>
            <div class="audit-entry">
                <span class="audit-timestamp">07 Jan 2025, 13:45:25</span>
                <span class="audit-icon validation">‚úì</span>
                <div class="audit-message">
                    <strong>Ariba Match Found</strong> - <span class="audit-field">Supplier</span>: Matched to "Gulf General Trading Company LLC" (Ariba ID: GGTC-SA-001) with 98% confidence
                </div>
            </div>
            <div class="audit-entry">
                <span class="audit-timestamp">07 Jan 2025, 13:45:25</span>
                <span class="audit-icon extraction">üìÑ</span>
                <div class="audit-message">
                    <strong>Low Confidence Warning</strong> - <span class="audit-field">Payment Terms</span>: "ÿµÿßŸÅŸä Ÿ£Ÿ† ŸäŸàŸÖ" ‚Üí "Net 30" (Confidence: 52%) - Manual review recommended
                </div>
            </div>
        </div>
    </div>

    <script>
        // Audit Trail Toggle
        function toggleAuditTrail() {
            const panel = document.getElementById('auditTrailPanel');
            panel.classList.toggle('expanded');
        }

        // Add hover effects for confidence badges
        document.querySelectorAll('.confidence-badge').forEach(badge => {
            badge.style.cursor = 'pointer';
            badge.title = 'Click to see extraction details';
        });

        // Simulate field click to edit
        document.querySelectorAll('.sap-input').forEach(input => {
            input.addEventListener('click', function() {
                if (this.readOnly) {
                    this.readOnly = false;
                    this.style.background = '#FFFFFF';
                    this.focus();
                    this.select();
                }
            });

            input.addEventListener('blur', function() {
                this.readOnly = true;
                this.style.background = '#F7F7F7';
            });
        });

        // ============================================
        // AI Copilot - Rust Shim + U2AI Integration
        // ============================================

        let copilotOpen = false;

        function toggleCopilot() {
            copilotOpen = !copilotOpen;
            const panel = document.getElementById('copilotPanel');
            const fab = document.getElementById('copilotFab');

            if (copilotOpen) {
                panel.classList.add('open');
                fab.classList.add('active');
                fab.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>';
                document.body.classList.add('copilot-open');
                document.getElementById('copilotInput').focus();
            } else {
                panel.classList.remove('open');
                fab.classList.remove('active');
                fab.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 011 1v3a1 1 0 01-1 1h-1v1a2 2 0 01-2 2H5a2 2 0 01-2-2v-1H2a1 1 0 01-1-1v-3a1 1 0 011-1h1a7 7 0 017-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 012-2z"/><circle cx="9" cy="13" r="1.25" fill="currentColor"/><circle cx="15" cy="13" r="1.25" fill="currentColor"/><path d="M9 17h6" stroke-linecap="round"/></svg>';
                document.body.classList.remove('copilot-open');
            }
        }

        function handleInputKeydown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function askQuestion(question) {
            document.getElementById('copilotInput').value = question;
            sendMessage();
        }

        function sendMessage() {
            const input = document.getElementById('copilotInput');
            const message = input.value.trim();
            if (!message) return;

            // Add user message
            addMessage('user', message);
            input.value = '';

            // Show typing indicator
            showTyping();

            // Simulate Rust Shim ‚Üí U2AI API call
            setTimeout(() => {
                hideTyping();
                const response = generateResponse(message);
                addMessage('assistant', response);
            }, 800 + Math.random() * 700);
        }

        function addMessage(type, content) {
            const container = document.getElementById('copilotMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `copilot-message ${type}`;

            const avatar = type === 'assistant' ? 'ü§ñ' : 'CT';

            messageDiv.innerHTML = `
                <div class="copilot-message-avatar">${avatar}</div>
                <div class="copilot-message-content">${content}</div>
            `;

            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function showTyping() {
            const container = document.getElementById('copilotMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'copilot-message assistant';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="copilot-message-avatar">ü§ñ</div>
                <div class="copilot-message-content">
                    <div class="copilot-typing">
                        <span></span><span></span><span></span>
                    </div>
                </div>
            `;
            container.appendChild(typingDiv);
            container.scrollTop = container.scrollHeight;
        }

        function hideTyping() {
            const typing = document.getElementById('typingIndicator');
            if (typing) typing.remove();
        }

        // U2AI Model Responses - Based on AP DOI & Saudi VAT Documentation
        function generateResponse(question) {
            const q = question.toLowerCase();

            if (q.includes('payment terms') || q.includes('low confidence') || q.includes('52%')) {
                return `<strong>Payment Terms Analysis</strong><br><br>
                    The field "ÿµÿßŸÅŸä Ÿ£Ÿ† ŸäŸàŸÖ" was extracted with <code>52% confidence</code> because:<br><br>
                    ‚Ä¢ The Arabic text uses informal formatting<br>
                    ‚Ä¢ Multiple interpretations possible: "Net 30", "30 Days Net", "Within 30 Days"<br>
                    ‚Ä¢ No exact match in our payment terms dictionary<br><br>
                    <strong>Suggestion:</strong> Verify the source document. The most likely value is <code>Net 30</code> based on context.
                    <div class="copilot-suggestions">
                        <button class="copilot-suggestion" onclick="applyCorrection('paymentTerms', 'Net 30')">Apply "Net 30"</button>
                        <button class="copilot-suggestion" onclick="askQuestion('Show me other payment term options')">See alternatives</button>
                    </div>`;
            }

            if (q.includes('translate') && q.includes('supplier')) {
                return `<strong>Supplier Name Translation</strong><br><br>
                    <strong>Arabic:</strong> ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿÆŸÑŸäÿ¨ ŸÑŸÑÿ™ÿ¨ÿßÿ±ÿ© ÿßŸÑÿπÿßŸÖÿ©<br>
                    <strong>English:</strong> Gulf General Trading Company LLC<br><br>
                    <strong>Translation Breakdown:</strong><br>
                    ‚Ä¢ ÿ¥ÿ±ŸÉÿ© (Sharika) = Company<br>
                    ‚Ä¢ ÿßŸÑÿÆŸÑŸäÿ¨ (Al-Khaleej) = The Gulf<br>
                    ‚Ä¢ ŸÑŸÑÿ™ÿ¨ÿßÿ±ÿ© (Li-Tijara) = For Trading<br>
                    ‚Ä¢ ÿßŸÑÿπÿßŸÖÿ© (Al-'Amma) = General<br><br>
                    <code>Confidence: 98%</code> - High match with Ariba supplier database.
                    <div class="copilot-suggestions">
                        <button class="copilot-suggestion" onclick="askQuestion('Check tax invoice compliance')">Check tax compliance</button>
                    </div>`;
            }

            if (q.includes('vat') || q.includes('tax') || q.includes('calculation')) {
                return `<strong>VAT Calculation Verification</strong> <em>(per ZATCA KSA regulations)</em><br><br>
                    ‚úÖ <strong>Calculation is correct!</strong><br><br>
                    <table style="font-size: 0.75rem; width: 100%;">
                        <tr><td>Subtotal:</td><td style="text-align: right;">55,000.00 SAR</td></tr>
                        <tr><td>VAT Rate:</td><td style="text-align: right;">15%</td></tr>
                        <tr><td>VAT Amount:</td><td style="text-align: right;">8,250.00 SAR</td></tr>
                        <tr style="font-weight: bold;"><td>Total:</td><td style="text-align: right;">63,250.00 SAR</td></tr>
                    </table><br>
                    The Saudi VAT rate of 15% has been correctly applied per ZATCA regulations.
                    <div class="copilot-suggestions">
                        <button class="copilot-suggestion" onclick="askQuestion('What is the invoice tax type?')">Check tax type</button>
                        <button class="copilot-suggestion" onclick="askQuestion('Is this a full tax invoice?')">Verify compliance</button>
                    </div>`;
            }

            if (q.includes('tax type') || q.includes('invoice type') || q.includes('full tax') || q.includes('simplified')) {
                return `<strong>Tax Invoice Classification</strong> <em>(per AP DOI)</em><br><br>
                    Based on the extracted fields, this invoice qualifies as:<br><br>
                    ‚úÖ <strong>Full Tax Invoice</strong><br><br>
                    <strong>Checklist verified:</strong><br>
                    ‚úì Invoice in Arabic language<br>
                    ‚úì "ŸÅÿßÿ™Ÿàÿ±ÿ© ÿ∂ÿ±Ÿäÿ®Ÿäÿ©" (Tax Invoice) label present<br>
                    ‚úì Supplier TRN: 300123456789003 (15-digit)<br>
                    ‚úì Customer name & address (Standard Chartered)<br>
                    ‚úì Sequential invoice number: INV-2025-04721<br>
                    ‚úì Date of issue: 2025-01-05<br>
                    ‚úì Line items with quantity, unit price, VAT<br>
                    ‚úì Net, VAT, and Gross amounts in SAR<br><br>
                    <strong>Tax Types per DOI:</strong><br>
                    ‚Ä¢ <code>FI</code> - Full Tax Invoice ‚Üê <em>Current</em><br>
                    ‚Ä¢ <code>SI</code> - Simplified Tax Invoice (‚â§500 BHD)<br>
                    ‚Ä¢ <code>RC</code> - Reverse Charge (overseas)<br>
                    ‚Ä¢ <code>TCN</code> - Tax Credit Note`;
            }

            if (q.includes('compliance') || q.includes('checklist') || q.includes('zatca') || q.includes('nbr')) {
                return `<strong>Tax Invoice Compliance Checklist</strong> <em>(per KSA VAT regulations)</em><br><br>
                    <table style="font-size: 0.75rem; width: 100%;">
                        <tr><td>1. Invoice in Arabic</td><td style="color: var(--sapPositiveColor);">‚úì Yes</td></tr>
                        <tr><td>2. "Tax Invoice" label</td><td style="color: var(--sapPositiveColor);">‚úì ŸÅÿßÿ™Ÿàÿ±ÿ© ÿ∂ÿ±Ÿäÿ®Ÿäÿ©</td></tr>
                        <tr><td>3. Supplier name & TRN</td><td style="color: var(--sapPositiveColor);">‚úì 300123456789003</td></tr>
                        <tr><td>4. Customer name (SCB)</td><td style="color: var(--sapPositiveColor);">‚úì ÿ≥ÿ™ÿßŸÜÿØÿ±ÿØ ÿ™ÿ¥ÿßÿ±ÿ™ÿ±ÿØ</td></tr>
                        <tr><td>5. Invoice date</td><td style="color: var(--sapPositiveColor);">‚úì 2025-01-05</td></tr>
                        <tr><td>6. Sequential number</td><td style="color: var(--sapPositiveColor);">‚úì INV-2025-04721</td></tr>
                        <tr><td>7. Line items & quantities</td><td style="color: var(--sapPositiveColor);">‚úì 3 items</td></tr>
                        <tr><td>8. VAT rate & amount</td><td style="color: var(--sapPositiveColor);">‚úì 15% / 8,250 SAR</td></tr>
                        <tr><td>9. Amounts in SAR</td><td style="color: var(--sapPositiveColor);">‚úì Yes</td></tr>
                    </table><br>
                    <strong>Result:</strong> Invoice is <code>ZATCA Compliant</code> ‚úÖ`;
            }

            if (q.includes('po') || q.includes('purchase order') || q.includes('e-proc') || q.includes('eproc')) {
                return `<strong>Purchase Order Status</strong> <em>(per AP DOI)</em><br><br>
                    ‚ö†Ô∏è <strong>No PO Number Detected</strong><br><br>
                    Per the Group Business Expenditure Standard, this invoice would be classified as a <strong>Manual Invoice (non e-Proc)</strong>.<br><br>
                    <strong>Required approvals:</strong><br>
                    1. Cost Centre Owner approval<br>
                    2. Country Supply Chain Manager approval<br>
                    3. CFO or delegate approval<br><br>
                    <strong>Process:</strong> Invoice should be scanned with non e-Proc memo to AP team (GBS Bangalore/Chennai).
                    <div class="copilot-suggestions">
                        <button class="copilot-suggestion" onclick="askQuestion('Generate non e-Proc memo')">Generate memo</button>
                    </div>`;
            }

            if (q.includes('memo') || q.includes('non e-proc') || q.includes('approval')) {
                return `<strong>Non e-Proc Memo Template</strong><br><br>
                    Per AP DOI Annexure 1, the following is required:<br><br>
                    <div style="background: #f5f5f5; padding: 0.75rem; border-radius: 0.25rem; font-size: 0.75rem;">
                    <strong>Invoice Details:</strong><br>
                    ‚Ä¢ Vendor: Gulf General Trading Company LLC<br>
                    ‚Ä¢ Invoice #: INV-2025-04721<br>
                    ‚Ä¢ Amount: 63,250.00 SAR<br>
                    ‚Ä¢ Purpose: Consulting Services Q4 2024<br><br>
                    <strong>Approvals Required:</strong><br>
                    ‚ñ° Cost Centre Owner<br>
                    ‚ñ° Supply Chain Manager<br>
                    ‚ñ° CFO / Delegate
                    </div><br>
                    <strong>Note:</strong> Ensure payment is within DOA limits per GDAM.`;
            }

            if (q.includes('gl') || q.includes('cost centre') || q.includes('chart') || q.includes('account')) {
                return `<strong>GL Account Structure</strong> <em>(per Saudi OTP Entry template)</em><br><br>
                    <table style="font-size: 0.75rem; width: 100%;">
                        <tr><td><strong>Field</strong></td><td><strong>Value</strong></td></tr>
                        <tr><td>Account</td><td>287961</td></tr>
                        <tr><td>Product</td><td>910</td></tr>
                        <tr><td>Department</td><td>8105</td></tr>
                        <tr><td>Operating Unit</td><td>800</td></tr>
                        <tr><td>Class</td><td>98</td></tr>
                        <tr><td>Affiliate</td><td>-</td></tr>
                        <tr><td>Project ID</td><td>-</td></tr>
                    </table><br>
                    <strong>PSID:</strong> <code>2002976</code>`;
            }

            if (q.includes('ariba') || q.includes('supplier match') || q.includes('match')) {
                return `<strong>Ariba Supplier Match Details</strong><br><br>
                    <strong>Best Match (98%):</strong><br>
                    ‚Ä¢ Gulf General Trading Company LLC<br>
                    ‚Ä¢ Ariba ID: <code>GGTC-SA-001</code><br>
                    ‚Ä¢ Status: ‚úÖ Approved Vendor<br>
                    ‚Ä¢ Category: Professional Services<br><br>
                    <strong>Partial Match (72%):</strong><br>
                    ‚Ä¢ Gulf Trading & General Services<br>
                    ‚Ä¢ Different legal entity - likely not a match<br><br>
                    <strong>Per AP DOI:</strong> Ensure vendor is on-boarded in PSAP. If not, screening must be performed and payment executed within 48 hours.
                    <div class="copilot-suggestions">
                        <button class="copilot-suggestion" onclick="askQuestion('Confirm GGTC-SA-001 as supplier')">Confirm match</button>
                    </div>`;
            }

            if (q.includes('alternative') || q.includes('options')) {
                return `<strong>Payment Terms Alternatives</strong><br><br>
                    Based on the Arabic text "ÿµÿßŸÅŸä Ÿ£Ÿ† ŸäŸàŸÖ", possible interpretations:<br><br>
                    1. <code>Net 30</code> - Most common (85% likelihood)<br>
                    2. <code>Due in 30 Days</code> - Alternative format<br>
                    3. <code>30 Days from Invoice</code> - Full description<br><br>
                    <div class="copilot-suggestions">
                        <button class="copilot-suggestion" onclick="applyCorrection('paymentTerms', 'Net 30')">Use "Net 30"</button>
                        <button class="copilot-suggestion" onclick="applyCorrection('paymentTerms', 'Due in 30 Days')">Use "Due in 30 Days"</button>
                    </div>`;
            }

            if (q.includes('confirm') && q.includes('ggtc')) {
                return `‚úÖ <strong>Supplier Confirmed</strong><br><br>
                    Supplier <code>GGTC-SA-001</code> (Gulf General Trading Company LLC) has been selected as the matched vendor.<br><br>
                    This will be logged in the audit trail for compliance per AP DOI requirements.`;
            }

            if (q.includes('reverse charge') || q.includes('overseas') || q.includes('foreign')) {
                return `<strong>Reverse Charge Assessment</strong><br><br>
                    ‚ùå <strong>Not Applicable</strong> - This is a domestic Saudi invoice.<br><br>
                    <strong>When Reverse Charge applies:</strong><br>
                    ‚Ä¢ Supplier is based outside KSA<br>
                    ‚Ä¢ Supply is taxable by nature<br>
                    ‚Ä¢ VAT must be calculated by SCB<br>
                    ‚Ä¢ Use SAMA exchange rate as of invoice date<br><br>
                    <strong>Current Invoice:</strong><br>
                    ‚Ä¢ Supplier Location: Riyadh, KSA<br>
                    ‚Ä¢ Tax Type: <code>FI</code> (Full Tax Invoice)`;
            }

            if (q.includes('withholding') || q.includes('wht')) {
                return `<strong>Withholding Tax (WHT) Assessment</strong><br><br>
                    ‚ùå <strong>Not Applicable</strong><br><br>
                    WHT only applies when:<br>
                    ‚Ä¢ Vendor location is outside Saudi Arabia<br><br>
                    <strong>Current Invoice:</strong><br>
                    ‚Ä¢ Supplier: Gulf General Trading Co. LLC<br>
                    ‚Ä¢ Location: Riyadh, KSA (domestic)<br>
                    ‚Ä¢ WHT Rate: N/A<br>
                    ‚Ä¢ Net Payable: 63,250.00 SAR (full amount)`;
            }

            // Default response
            return `I understand you're asking about: "<em>${question}</em>"<br><br>
                Based on the <strong>AP DOI</strong> and <strong>Saudi VAT guidelines</strong>, I can help with:<br><br>
                ‚Ä¢ Invoice field validation<br>
                ‚Ä¢ Tax invoice compliance (ZATCA)<br>
                ‚Ä¢ VAT categorization (FI/SI/RC/TCN)<br>
                ‚Ä¢ PO vs Manual invoice processing<br>
                ‚Ä¢ GL account mapping<br>
                ‚Ä¢ Ariba supplier matching<br><br>
                <div class="copilot-suggestions">
                    <button class="copilot-suggestion" onclick="askQuestion('Is this a full tax invoice?')">Check tax type</button>
                    <button class="copilot-suggestion" onclick="askQuestion('Show GL account structure')">GL accounts</button>
                    <button class="copilot-suggestion" onclick="askQuestion('Is a PO required?')">PO requirement</button>
                </div>`;
        }

        function applyCorrection(field, value) {
            // Simulate applying correction
            addMessage('assistant', `‚úÖ <strong>Correction Applied</strong><br><br>Field "<code>${field}</code>" updated to "<code>${value}</code>".<br><br>This change has been logged in the audit trail and will be used to improve future extractions via the feedback loop.`);

            // Update the actual field if it exists
            if (field === 'paymentTerms') {
                const inputs = document.querySelectorAll('.sap-input');
                inputs.forEach(input => {
                    if (input.value === 'Net 30' || input.value.includes('30')) {
                        input.style.borderColor = 'var(--sapPositiveColor)';
                        const badge = input.nextElementSibling;
                        if (badge) {
                            badge.className = 'confidence-badge confidence-high';
                            badge.innerHTML = '<svg class="confidence-icon" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.854 5.146l-4.5 4.5a.5.5 0 01-.708 0l-2-2a.5.5 0 11.708-.708L7 9.586l4.146-4.147a.5.5 0 01.708.708z"/></svg> Corrected';
                        }
                    }
                });
            }
        }
    </script>
</body>
</html>
