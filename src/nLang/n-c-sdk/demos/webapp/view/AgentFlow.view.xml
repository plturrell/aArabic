<mvc:View
    controllerName="galaxy.sim.controller.AgentFlow"
    xmlns="sap.m"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:l="sap.ui.layout"
    xmlns:core="sap.ui.core"
    xmlns:html="http://www.w3.org/1999/xhtml"
    displayBlock="true">

    <Page
        id="agentFlowPage"
        title="Agent Flow - Petri Net Visualization"
        showNavButton="false"
        class="sapUiContentPadding">

        <headerContent>
            <SegmentedButton
                id="viewModeButton"
                selectedKey="split"
                selectionChange=".onViewModeChange">
                <items>
                    <SegmentedButtonItem key="network" icon="sap-icon://network" text="Network"/>
                    <SegmentedButtonItem key="process" icon="sap-icon://process" text="Process"/>
                    <SegmentedButtonItem key="split" icon="sap-icon://split" text="Split"/>
                </items>
            </SegmentedButton>
        </headerContent>

        <content>
            <VBox height="100%" class="sapUiSmallMargin">

                <!-- Info Panel -->
                <Panel
                    headerText="About Petri Nets"
                    expandable="true"
                    expanded="false"
                    class="sapUiSmallMarginBottom">
                    <content>
                        <Text text="Petri Nets are mathematical models for distributed systems. They consist of Places (circles), Transitions (rectangles), and Tokens (dots) that flow through the network. This visualization shows agent workflow execution with real-time token movement."/>
                    </content>
                </Panel>

                <!-- Split Container for Network and Process Views -->
                <l:Splitter
                    id="mainSplitter"
                    height="600px"
                    orientation="Horizontal">

                    <!-- Network Graph Pane -->
                    <l:contentAreas>
                        <l:SplitterLayoutData size="60%"/>
                        <VBox id="networkPane" class="sapUiSmallMargin">
                            <Title text="Petri Net Structure" level="H3" class="sapUiSmallMarginBottom"/>
                            <html:div
                                id="networkGraphContainer"
                                style="width: 100%; height: 500px; border: 1px solid #ccc; border-radius: 4px; background: #fafafa;"/>
                        </VBox>
                    </l:contentAreas>

                    <!-- Process Flow Pane -->
                    <l:contentAreas>
                        <l:SplitterLayoutData size="40%"/>
                        <VBox id="processPane" class="sapUiSmallMargin">
                            <Title text="Execution Timeline" level="H3" class="sapUiSmallMarginBottom"/>
                            <html:div
                                id="processFlowContainer"
                                style="width: 100%; height: 500px; border: 1px solid #ccc; border-radius: 4px; background: #fafafa; overflow: auto;"/>
                        </VBox>
                    </l:contentAreas>

                </l:Splitter>

                <!-- Statistics Panel -->
                <Panel
                    headerText="Statistics"
                    class="sapUiSmallMarginTop">
                    <content>
                        <l:HorizontalLayout>
                            <l:VerticalLayout class="sapUiSmallMarginEnd">
                                <Label text="Total Places:"/>
                                <Text id="placesCount" text="0" class="sapUiTinyMarginTop"/>
                            </l:VerticalLayout>
                            <l:VerticalLayout class="sapUiSmallMarginEnd">
                                <Label text="Total Transitions:"/>
                                <Text id="transitionsCount" text="0" class="sapUiTinyMarginTop"/>
                            </l:VerticalLayout>
                            <l:VerticalLayout class="sapUiSmallMarginEnd">
                                <Label text="Active Tokens:"/>
                                <Text id="tokensCount" text="0" class="sapUiTinyMarginTop"/>
                            </l:VerticalLayout>
                            <l:VerticalLayout>
                                <Label text="Executions:"/>
                                <Text id="executionsCount" text="0" class="sapUiTinyMarginTop"/>
                            </l:VerticalLayout>
                        </l:HorizontalLayout>
                    </content>
                </Panel>

            </VBox>
        </content>

        <footer>
            <Toolbar>
                <Button
                    id="playButton"
                    icon="sap-icon://play"
                    text="Play"
                    type="Emphasized"
                    press=".onPlaySimulation"/>
                <Button
                    id="pauseButton"
                    icon="sap-icon://pause"
                    text="Pause"
                    enabled="false"
                    press=".onPauseSimulation"/>
                <Button
                    icon="sap-icon://reset"
                    text="Reset"
                    press=".onResetSimulation"/>
                <ToolbarSpacer/>
                <Label text="Speed:" class="sapUiTinyMarginEnd"/>
                <Slider
                    id="speedSlider"
                    value="1"
                    min="0.1"
                    max="5"
                    step="0.1"
                    width="200px"
                    enableTickmarks="true"
                    change=".onSpeedChange"/>
                <Button
                    icon="sap-icon://download"
                    text="Export"
                    press=".onExport"/>
            </Toolbar>
        </footer>

    </Page>

</mvc:View>