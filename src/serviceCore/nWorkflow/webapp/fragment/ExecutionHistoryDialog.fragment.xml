<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core">

    <Dialog
        id="executionHistoryDialog"
        title="{i18n>executionHistory}"
        contentWidth="800px"
        contentHeight="500px"
        draggable="true"
        resizable="true">
        
        <content>
            <VBox class="sapUiSmallMargin">
                <!-- Filter Bar for Executions -->
                <Toolbar class="sapUiTinyMarginBottom">
                    <SearchField
                        id="executionSearchField"
                        placeholder="{i18n>searchPlaceholder}"
                        width="200px"
                        liveChange=".onExecutionSearchChange"/>
                    <ToolbarSeparator/>
                    <Label text="{i18n>filterByStatus}"/>
                    <Select
                        id="executionStatusFilter"
                        selectedKey="all"
                        change=".onExecutionStatusFilterChange">
                        <core:Item key="all" text="{i18n>all}"/>
                        <core:Item key="running" text="{i18n>running}"/>
                        <core:Item key="completed" text="{i18n>completed}"/>
                        <core:Item key="failed" text="{i18n>failed}"/>
                    </Select>
                    <ToolbarSpacer/>
                    <Button
                        icon="sap-icon://refresh"
                        tooltip="Refresh"
                        press=".onRefreshExecutions"/>
                </Toolbar>
                
                <!-- Execution History Table -->
                <Table
                    id="executionHistoryTable"
                    items="{/executions}"
                    growing="true"
                    growingThreshold="10"
                    noDataText="{i18n>noExecutions}">
                    <columns>
                        <Column width="15%">
                            <Text text="{i18n>executionId}"/>
                        </Column>
                        <Column width="25%">
                            <Text text="{i18n>workflowName}"/>
                        </Column>
                        <Column width="12%" hAlign="Center">
                            <Text text="{i18n>executionStatus}"/>
                        </Column>
                        <Column width="18%">
                            <Text text="{i18n>startTime}"/>
                        </Column>
                        <Column width="18%">
                            <Text text="{i18n>endTime}"/>
                        </Column>
                        <Column width="12%" hAlign="End">
                            <Text text="{i18n>duration}"/>
                        </Column>
                    </columns>
                    <items>
                        <ColumnListItem>
                            <cells>
                                <Text text="{id}"/>
                                <HBox alignItems="Center">
                                    <core:Icon src="sap-icon://workflow" class="sapUiTinyMarginEnd"/>
                                    <Text text="{workflowName}"/>
                                </HBox>
                                <ObjectStatus
                                    text="{status}"
                                    state="{= ${status} === 'completed' ? 'Success' : (${status} === 'running' ? 'Information' : 'Error') }"
                                    icon="{= ${status} === 'completed' ? 'sap-icon://accept' : (${status} === 'running' ? 'sap-icon://synchronize' : 'sap-icon://error') }"/>
                                <Text text="{startTime}"/>
                                <Text text="{endTime}"/>
                                <Text text="{duration}"/>
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>
            </VBox>
        </content>
        
        <beginButton>
            <Button
                text="{i18n>close}"
                press=".onCloseExecutionHistoryDialog"/>
        </beginButton>
    </Dialog>

</core:FragmentDefinition>

